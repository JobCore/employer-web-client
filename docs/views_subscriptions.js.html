<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: views/subscriptions.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: views/subscriptions.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState, useEffect } from "react";
import Flux from "@4geeksacademy/react-flux-dash";
import PropTypes from 'prop-types';
import {store, createSubscription, searchMe } from '../actions.js';
import { Button } from '../components/index';
import {Notify} from 'bc-react-notifier';
import { GET } from "../utils/api_wrapper.js";

import Tooltip from 'rc-tooltip';
import 'rc-tooltip/assets/bootstrap_white.css';

//gets the queryst
export const Subscription = (data) => {

    const _defaults = {
        id: '',
        title: '',
        unique_name: '',
        serialize: function(){

            const newLocation = {
//                status: (this.status == 'UNDEFINED') ? 'DRAFT' : this.status,
            };

            return Object.assign(this, newLocation);
        }
    };

    let _location = Object.assign(_defaults, data);
    return {
        validate: () => {
            //if(validator.isEmpty(_location.title)) throw new ValidationError('The location title cannot be empty');
            return _location;
        },
        defaults: () => {
            return _defaults;
        },
        getFormData: () => {
            const _formShift = {
                //title: _location.title,
            };
            return _formShift;
        }
    };
};

/**
 * YourSubscription
 */
const FeatureIndicator = ({fixed, additional, className, boolean}) => &lt;div className={`m-0 ${className}`}>
    { boolean !== null ?
        &lt;div>{boolean ? "Yes" : "No"}&lt;/div>
        :
        &lt;div>
            {fixed > 9999 ? "Unlimited" : fixed > 0 &amp;&amp; `${fixed} / mo.`}
            {fixed === 0 &amp;&amp; additional > 0 ? 
                "$" + additional + "/each"
                : !additional || additional &lt;=0 ? 
                    '' 
                    :
                    &lt;Tooltip placement="top" trigger={['hover']} overlay={&lt;span>
                        {fixed > 0 &amp;&amp; fixed &lt; 9999 &amp;&amp; additional > 0 &amp;&amp; " Plus "}
                        {additional > 0 &amp;&amp; "$" + additional + "/each"}
                        {fixed > 0 &amp;&amp; fixed &lt; 9999 &amp;&amp; additional > 0 &amp;&amp; ` after the ${fixed} limit has been reached `}
                    &lt;/span>}>
                        &lt;i className="fas fa-plus-circle ml-1">&lt;/i>
                    &lt;/Tooltip>
            }
        &lt;/div>
    }
&lt;/div>;
FeatureIndicator.propTypes = {
  className: PropTypes.string,
  boolean: PropTypes.bool,
  fixed: PropTypes.number,
  additional: PropTypes.number
};
FeatureIndicator.defaultProps = {
  className: '',
  fixed: 0,
  boolean: null,
  additional: 0
};
export const YourSubscription = (props) => {

    const [ employer, setEmployer ] = useState(store.getState('current_employer'));
    const [ plans, setPlans ] = useState([]);
    const [ customer, setCustomer ] = useState('');
    const [ subscription, setSubscription ] = useState('');

    useEffect(() => {

        const employerSubscription = store.subscribe('current_employer', (_employer) => setEmployer(_employer));
        GET('subscriptions').then(subs => setPlans(subs));

        searchMe('subscription').then(res => {
            if(Array.isArray(res) &amp;&amp; res[1 - res.length]){
               
                const cus = res[1 - res.length]['stripe_cus'];
                const sub = res[1 - res.length]['stripe_sub'];

                if(cus){
                    setCustomer(res[1 - res.length]['stripe_cus']);
                }
                if(sub){
                    setSubscription(res[1 - res.length]['stripe_sub']);
                }
            }
        });

        return () => {
            employerSubscription.unsubscribe();
        };
    }, []);
    
    
    
    if(!employer) return "Loading";
    return (&lt;div>
        &lt;div className="row">
            &lt;div className="col-12">
                Hello {employer.title}
                &lt;p>Current subscription: {employer.active_subscription ? employer.active_subscription.title : "No active subscription"}&lt;/p>
            &lt;/div>
        &lt;/div>
        &lt;div className="row">
            &lt;div className="col-3 text-center">
                &lt;h2>Features&lt;/h2>
                &lt;p className="m-0">Base Price&lt;/p>
                &lt;p className="m-0">Job Postings /mo.&lt;/p>
                &lt;p className="m-0">Maximum active employees / mo.&lt;/p>
                &lt;p className="m-0">Maximum Clock In/Out / mo.&lt;/p>
                &lt;p className="m-0">Talent Search	&lt;/p>
                &lt;p className="m-0">Rate Talent&lt;/p>
                &lt;p className="m-0">Invite Talent Manually&lt;/p>
                &lt;p className="m-0">Geo Clock In/Out report&lt;/p>
                &lt;p className="m-0">Payroll Reports&lt;/p>
                &lt;p className="m-0">Create favorite employees list size	&lt;/p>
                &lt;p className="m-0">Smart Calendar Features&lt;/p>
                &lt;p className="m-0">Pre Approved Trusted Talent&lt;/p>
                &lt;p className="m-0">On-line Payments&lt;/p>
                &lt;p className="m-0">Pre calculated deductions&lt;/p>
                {/* &lt;p className="m-0">QuickBooks Integration&lt;/p> */}
            &lt;/div>
            {plans.map(p => 
                &lt;div key={p.id} className="col-2 text-center">
                    &lt;h2>{p.title}&lt;/h2>
                    &lt;p className="m-0">${p.price_month}/month&lt;/p>
                    &lt;FeatureIndicator fixed={p.feature_max_shifts} additional={p.price_per_shifts} />
                    &lt;FeatureIndicator fixed={p.feature_max_active_employees} additional={p.price_per_active_employees} />
                    &lt;FeatureIndicator fixed={p.feature_max_clockins} additional={p.price_per_active_employees} />
                    &lt;FeatureIndicator boolean={p.feature_talent_search} />
                    &lt;FeatureIndicator boolean={true} />
                    &lt;FeatureIndicator fixed={p.feature_max_invites} additional={p.price_per_invites} />
                    &lt;FeatureIndicator boolean={true} />
                    &lt;FeatureIndicator boolean={p.feature_payroll_report} />
                    &lt;FeatureIndicator fixed={p.feature_max_favorite_list_size} />
                    &lt;FeatureIndicator boolean={p.feature_smart_calendar} />
                    &lt;FeatureIndicator boolean={p.feature_trusted_talents} />
                    &lt;FeatureIndicator boolean={p.feature_ach_payments} />
                    &lt;FeatureIndicator boolean={p.feature_calculate_deductions} />
                    {/* &lt;FeatureIndicator boolean={p.feature_quickbooks_integration} /> */}
                    { (!employer.active_subscription || employer.active_subscription.id !== p.id) &amp;&amp;
                        &lt;Button className="w-100 mt-2" onClick={() => {
                            const noti = Notify.info("Are you sure? You will lose any other subscription you may have", (answer) => {
                                if (answer) createSubscription({ subscription: p.id, stripe_cus: customer, stripe_sub: subscription }, props.history);
                                noti.remove();
                            });
                        }}>Apply&lt;/Button>
                    }
                &lt;/div>
            )}
        &lt;/div>
        &lt;div className="mt-4 pt-4">
            &lt;em>If you wish to cancel your subscription please contact us at support@jobcore.co&lt;/em>
        &lt;/div>
    &lt;/div>);
};
YourSubscription.propTypes = {
  onSave: PropTypes.func.isRequired,
  onCancel: PropTypes.func.isRequired,
  onChange: PropTypes.func.isRequired,
  formData: PropTypes.object,
  catalog: PropTypes.object //contains the data needed for the form to load
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">JSDoc of employer-web-client</a></h2><h3>Classes</h3><ul><li><a href="MakePayment.html">MakePayment</a></li><li><a href="Metrics.html">Metrics</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AddFavlistsToTalent">AddFavlistsToTalent</a></li><li><a href="global.html#ApplicantExtendedCard">ApplicantExtendedCard</a></li><li><a href="global.html#ApplicationDetails">ApplicationDetails</a></li><li><a href="global.html#BarChart">BarChart</a></li><li><a href="global.html#ClockInsDataGenerator">ClockInsDataGenerator</a></li><li><a href="global.html#ClockOutsDataGenerator">ClockOutsDataGenerator</a></li><li><a href="global.html#CreateDeduction">CreateDeduction</a></li><li><a href="global.html#createMapOptions">createMapOptions</a></li><li><a href="global.html#EditOrAddExpiredShift">EditOrAddExpiredShift</a></li><li><a href="global.html#EditOrAddShift">EditOrAddShift</a></li><li><a href="global.html#FeatureIndicator">FeatureIndicator</a></li><li><a href="global.html#fetchAllIfNull">fetchAllIfNull</a></li><li><a href="global.html#fetchPeyrollPeriodPayments">fetchPeyrollPeriodPayments</a></li><li><a href="global.html#FilterApplications">FilterApplications</a></li><li><a href="global.html#filterClockins">filterClockins</a></li><li><a href="global.html#FilterLocations">FilterLocations</a></li><li><a href="global.html#FilterShifts">FilterShifts</a></li><li><a href="global.html#FilterTalents">FilterTalents</a></li><li><a href="global.html#GeneralStats">GeneralStats</a></li><li><a href="global.html#GET">GET</a></li><li><a href="global.html#getDeductionsReport">getDeductionsReport</a></li><li><a href="global.html#getPaymentsReport">getPaymentsReport</a></li><li><a href="global.html#Hours">Hours</a></li><li><a href="global.html#HoursDataGenerator">HoursDataGenerator</a></li><li><a href="global.html#InviteTalentToJobcore">InviteTalentToJobcore</a></li><li><a href="global.html#InviteUserToCompanyJobcore">InviteUserToCompanyJobcore</a></li><li><a href="global.html#JobSeekers">JobSeekers</a></li><li><a href="global.html#JobSeekersDataGenerator">JobSeekersDataGenerator</a></li><li><a href="global.html#makeEmployeePayment">makeEmployeePayment</a></li><li><a href="global.html#NewJobSeekersDataGenerator">NewJobSeekersDataGenerator</a></li><li><a href="global.html#PendingInvites">PendingInvites</a></li><li><a href="global.html#PendingJobcoreInvites">PendingJobcoreInvites</a></li><li><a href="global.html#PendingRatings">PendingRatings</a></li><li><a href="global.html#PieChart">PieChart</a></li><li><a href="global.html#Punctuality">Punctuality</a></li><li><a href="global.html#Queue">Queue</a></li><li><a href="global.html#QueueData">QueueData</a></li><li><a href="global.html#RateShift">RateShift</a></li><li><a href="global.html#RatingDetails">RatingDetails</a></li><li><a href="global.html#RatingEmployees">RatingEmployees</a></li><li><a href="global.html#Ratings">Ratings</a></li><li><a href="global.html#ReviewTalentAndShift">ReviewTalentAndShift</a></li><li><a href="global.html#SearchShiftToInviteTalent">SearchShiftToInviteTalent</a></li><li><a href="global.html#SearchTalentToInviteToShift">SearchTalentToInviteToShift</a></li><li><a href="global.html#ShiftApplicants">ShiftApplicants</a></li><li><a href="global.html#ShiftDetails">ShiftDetails</a></li><li><a href="global.html#ShiftEmployees">ShiftEmployees</a></li><li><a href="global.html#ShiftInvites">ShiftInvites</a></li><li><a href="global.html#Shifts">Shifts</a></li><li><a href="global.html#ShiftsDataGenerator">ShiftsDataGenerator</a></li><li><a href="global.html#ShiftTalentClockins">ShiftTalentClockins</a></li><li><a href="global.html#TalentDetails">TalentDetails</a></li><li><a href="global.html#UpdateDeduction">UpdateDeduction</a></li><li><a href="global.html#updateProfileImage">updateProfileImage</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Wed Oct 05 2022 17:57:01 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
